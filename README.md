# DrBooksFirst assessment

## Problem
DrFirst is a health tech company that makes an e-prescribing tool, but let's say we decided to switch gears and are now a new mail-delivery book startup The service works like this: you fill out a profile with us about your book preferences, and we will send you 5 books each month for free. Whatever you like you keep and pay for, and whatever you don't like you send back. Just like one of those box services in real life (e.g. Stitch Fix, HelloFresh, BarkBox, etc.)

As a company we have to buy our books ahead of time. We took out a loan last month to buy our original batch of books. The value of the loan was the total cost of all the books that we bought. We made some money back through customers buying our books last month. Next month, we know which books we will be sending to which customers, but we do not know who will buy what books. It costs $0.60/book each way for shipping books to and from customers. The question for you to answer is:

*Will we be able to both pay back our loan and afford our next book purchase order?*

## Data
The data provided to help answer this question. All of the following are csv files.

original_purchase_order: Quantity of books originally purchased indexed by a unique product ID.
next_purchase_order: Planned quantity of books to purchase at the end of next month indexed by a unique product ID.
customer_features: Customer features generated by the profiles that customers fill out with us indexed by a unique customer ID.
product_features: Product features that we have generated from our knowledge of our books indexed by a unique product ID.
last_month_assortment: Data on which books were sent to which customers and whether or not the customer purchased the book. There is no index.
next_month_assortment: Data on which books will be sent to which customers next month. There is no index.

## Solution
To proceed with answering the question of whether the company will be able to pay the loan back and be able to meet the new purchase order, the equation of value needs to be stated.

This equation consists of the total costs and total revenue:
### Total Costs :
    t_org: Total value of original books purchased+
    t_new: Total value of new books planning to be purchased+
    0.6$ * num_t_last: number of total books sent for last assortment+
    0.6$ * num_np_last: number of books NOT PURCHASED for last assortment+
    0.6$ * num_t_next: number of total books sent for next assortment +
    0.6$ * num_np_next: number of books NOT PURCHASED for next assortment (Assessed using an ML model)+
    
### Total Revenue : 
    t_p_last: Total value of the number of books PURCHASED for last assortment+
    t_p_next: Total value of the number of books PURCHASED for next assortment (Assessed using an ML model)
    
### Model

RandomForest - Since the data is qualitative and mainly categorical , it makes sense to use decision trees, with
an ensemble method and hence random forests. The below performs a Random Forest on the model for a number if parameters.
To aid with the code being run quicker this has already been run, and the best parameters have been chosen for the model.
The model has been tested using cross validation.

Finally proceeding to computing the equation of value. Any equation of value is incomplete without the rate of interest.
### There are 2 rates of interest here:
    Interest on the loan
    Interest on the revenue generated from the books
    
### Assumptions for the equation of value: 
1. The loan was purchased one month ago at month 0, is payable in 6 months as a lumpsum.
2. The last month assortment was sent for month 0.
3. The last month assortment will be sent a month from the present, hence month 2.
4. The next purchase will be assumed to be made on month 6, when the loan is due.

Interest on shipping costs have been ignored for materiality.    
It must be noted that other costs, such as inventory costs, cost of books being damaged when being sent back , etc have been ignored.
